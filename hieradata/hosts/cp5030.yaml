profile::cache::haproxy::version: haproxy27
profile::cache::haproxy::sticktables:
  - name: limit-by-path
    type: string
    len: 256
    size: 1m
    expire: 60s
    store:
      - bytes_out_rate(1s)

profile::cache::haproxy::filters:
  - direction: out
    name: limit-by-path
    size: 300m
    key: path
    table: limit-by-path

profile::cache::haproxy::post_acl_actions:
  tls:
    - context: http-request
      verb: set-bandwidth-limit limit-by-path

lookup_options:
  profile::cache::haproxy::sticktables:
    merge:
      strategy: deep
  profile::cache::haproxy::post_acl_actions:
    merge:
      strategy: deep
